<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>12 Generalized Linear Models | Using R for ecological modeling in USACE</title>
<meta name="author" content="Ed Stowe">
<meta name="generator" content="bookdown 0.42 with bs4_book()">
<meta property="og:title" content="12 Generalized Linear Models | Using R for ecological modeling in USACE">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="12 Generalized Linear Models | Using R for ecological modeling in USACE">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<meta name="description" content="This module will teach you how to use Generalized Linear Models to assess the importance of management-relevant environmental factors for fish species Authors: Ed StoweLast update:...">
<meta property="og:description" content="This module will teach you how to use Generalized Linear Models to assess the importance of management-relevant environmental factors for fish species Authors: Ed StoweLast update:...">
<meta name="twitter:description" content="This module will teach you how to use Generalized Linear Models to assess the importance of management-relevant environmental factors for fish species Authors: Ed StoweLast update:...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Using R for ecological modeling in USACE</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Course overview</a></li>
<li><a class="" href="required-set-up-for-the-course.html">Required set-up for the course</a></li>
<li class="book-part">Basic Training on R and RStudio</li>
<li><a class="" href="introduction-to-r-and-rstudio.html"><span class="header-section-number">1</span> Introduction to R and RStudio</a></li>
<li><a class="" href="data-visualization-with-ggplot2.html"><span class="header-section-number">2</span> Data Visualization with ggplot2</a></li>
<li><a class="" href="exploring-and-understanding-data.html"><span class="header-section-number">3</span> Exploring and understanding data</a></li>
<li><a class="" href="manipulating-tabular-data.html"><span class="header-section-number">4</span> Manipulating Tabular Data</a></li>
<li class="book-part">Ecological Modeling in R</li>
<li><a class="" href="conceptual-ecological-models.html"><span class="header-section-number">5</span> Conceptual Ecological Models</a></li>
<li class="book-part">Habitat Models</li>
<li><a class="" href="background-on-habitat-models-in-usace.html"><span class="header-section-number">6</span> Background on habitat models in USACE</a></li>
<li><a class="" href="habitat-suitability-index-models-with-ecorest.html"><span class="header-section-number">7</span> Habitat Suitability Index models with ecorest</a></li>
<li><a class="" href="ecorest-web-app.html"><span class="header-section-number">8</span> Ecorest Web App</a></li>
<li><a class="" href="sensitivity-and-uncertainty-analysis-for-habitat-suitability-index-hsi-models.html"><span class="header-section-number">9</span> Sensitivity and uncertainty analysis for habitat suitability index (HSI) models</a></li>
<li><a class="" href="spatial-habitat-models.html"><span class="header-section-number">10</span> Spatial Habitat Models</a></li>
<li class="book-part">Linear Models for informing planning HSIs</li>
<li><a class="" href="linear-models.html"><span class="header-section-number">11</span> Linear Models</a></li>
<li><a class="active" href="generalized-linear-models.html"><span class="header-section-number">12</span> Generalized Linear Models</a></li>
<li><a class="" href="random-effects.html"><span class="header-section-number">13</span> Random Effects</a></li>
<li><a class="" href="generalized-additive-models.html"><span class="header-section-number">14</span> Generalized Additive Models</a></li>
<li class="book-part">Machine Learning</li>
<li><a class="" href="random-forest.html"><span class="header-section-number">15</span> Random Forest</a></li>
<li><a class="" href="boosted-regression-trees.html"><span class="header-section-number">16</span> Boosted Regression Trees</a></li>
<li class="book-part">Other Modeling Approaches</li>
<li><a class="" href="population-modeling.html"><span class="header-section-number">17</span> Population Modeling</a></li>
<li><a class="" href="network-models-and-connectivity.html"><span class="header-section-number">18</span> Network Models and Connectivity</a></li>
<li><a class="" href="agent-based-models.html"><span class="header-section-number">19</span> Agent-based Models</a></li>
<li class="book-part">Models and decision-making</li>
<li><a class="" href="decision-support.html"><span class="header-section-number">20</span> Decision Support</a></li>
<li><a class="" href="annualizing-benefits-and-costs-with-ecorest-and-engrecon.html"><span class="header-section-number">21</span> Annualizing benefits and costs with ecorest and EngrEcon</a></li>
<li><a class="" href="ceica-chapter.html"><span class="header-section-number">22</span> Cost-Effectiveness and Incremental Cost Analysis (CEICA) with ecorest</a></li>
<li class="book-part">Models Integration</li>
<li><a class="" href="model-integration.html"><span class="header-section-number">23</span> Model Integration</a></li>
<li class="book-part">Other R applications</li>
<li><a class="" href="r-for-gis.html"><span class="header-section-number">24</span> R for GIS</a></li>
<li class="book-part">Environmental data sources</li>
<li><a class="" href="using-r-for-data-access.html"><span class="header-section-number">25</span> Using R for data access</a></li>
<li><a class="" href="usgs-gage-data-using-the-dataretrieval-package.html"><span class="header-section-number">26</span> USGS gage data using the dataRetrieval package</a></li>
<li><a class="" href="national-hydrography-dataset.html"><span class="header-section-number">27</span> National Hydrography Dataset</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="generalized-linear-models" class="section level1" number="12">
<h1>
<span class="header-section-number">12</span> Generalized Linear Models<a class="anchor" aria-label="anchor" href="#generalized-linear-models"><i class="fas fa-link"></i></a>
</h1>
<p><strong>This module will teach you how to use Generalized Linear Models to assess the importance of management-relevant environmental factors for fish species</strong></p>
<p><em>Authors: Ed Stowe</em><br><em>Last update: 2025-10-30</em><br><em>Acknowledgements: Some inspiration/language/code have been used or adapted with permission from: Ben Staton’s <a href="https://bstaton1.github.io/au-r-workshop/ch3.html#glms">Intro to R for Natural Resources course</a>; and Quebec Center for biodiversity Science’s <a href="https://r.qcbs.ca/workshop06/book-en/">Generalized linear model workshop</a></em></p>
<div id="learning-objectives-8" class="section level2" number="12.1">
<h2>
<span class="header-section-number">12.1</span> Learning objectives<a class="anchor" aria-label="anchor" href="#learning-objectives-8"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Understand how generalized linear models might be used to inform USACE planning proccess</li>
<li>Understand why and when to use generalized linear models</li>
<li>Learn how to interpret output from binomial and negative binomial regression</li>
</ul>
</div>
<div id="generalized-linear-model-background" class="section level2" number="12.2">
<h2>
<span class="header-section-number">12.2</span> Generalized Linear Model Background<a class="anchor" aria-label="anchor" href="#generalized-linear-model-background"><i class="fas fa-link"></i></a>
</h2>
<p>When USACE biologists and planners are trying to understand important factors controlling a species that will be the target of restoration, they may use linear modeling to determine if empirical data matches the expectation of a habitat model. Or if a habitat model doesn’t exist, it may make sense to use linear modeling to inform the habitat models. In some cases, the linear models that we explore in the previous section, linear models, may suit this purpose. Linear models assume that the residuals of a model are normally-distributed and that the response variable and the predictor variables are linearly-related. However several ubiquitous types of data used in ecological modeling–such as presence/absence data or counts of organisms–do not follow these assumptions. For these types of data, <strong>Generalized linear models (GLMs)</strong> can overcome these problems. Therefore, if USACE planners wish to see how certain environmental variables are related to these types of biological outcomes (e.g., presence of a species), they may wish to use GLMs</p>
<p>Here we will not go into all of the statistical details of GLMs, but for a more in-depth description of the statistical underpinnings, see <a href="https://r.qcbs.ca/workshop06/book-en/">here</a> and elsewhere. It is important, however, to understand three key elements of GLMs:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Response distribution</strong>: A probability distribution for the response variable Y, such as the binomial distribution for binary data or the Poisson distribution for count data.<br>
</li>
<li>
<strong>Linear predictor</strong>: A linear combination of explanatory variables (η=Xβ), analogous to a standard linear model.<br>
</li>
<li>
<strong>Link function</strong>: A function that relates the mean of the response variable’s distribution (μ) to the linear predictor (η). The choice of link function is typically guided by the response distribution; for example, count data modeled with a Poisson distribution often use the natural logarithm as the link function.</li>
</ol>
<p>The most common examples of GLMs in ecology are logistic regression for binary data or poisson and negative binomial regression for count data.</p>
</div>
<div id="logistic-regression" class="section level2" number="12.3">
<h2>
<span class="header-section-number">12.3</span> Logistic regression<a class="anchor" aria-label="anchor" href="#logistic-regression"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Binary</strong> data, which have two opposite outcomes, is common in ecology, for example, present/absent, success/failure, lived/died, male/female, etc. If you want to predict how the probability of one outcome over its opposite changes depending on some other variable(s), then you need to use the <strong>logistic regression model</strong>, which is written as:</p>
<p><span class="math display" id="eq:logis-reg">\[\begin{equation}
  logit(p_i)=\beta_0 + \beta_1 x_{i1} + ... + \beta_j x_{ij}+ ... + \beta_n x_{in}, y_i \sim Bernoulli(p_i)
\tag{12.1}
\end{equation}\]</span></p>
<p>Here, <span class="math inline">\(p_i\)</span> is the probability of success for trial <span class="math inline">\(i\)</span> at the values of the predictor variables <span class="math inline">\(x_{ij}\)</span>. The <span class="math inline">\(logit(p_i)\)</span> is the <strong>link function</strong> that links the linear parameter scale to the data scale. The logit link function constrains the value of <span class="math inline">\(p_i\)</span> to be between 0 and 1 regardless of the values of the <span class="math inline">\(\beta\)</span> coefficients.</p>
<p>The logit link is equivalent to the log odds ratio, in other words, the natural log of how likely an event is compared to it not happening.</p>
<p>Therefore, with logistic regression, the model will calculate the log odds of an outcome, so if we want to know the odds ratio (i.e., ), we just take the inverse log. The example analysis that we conduct will make this more obvious.</p>
<div id="example-logistic-regression-anaysis" class="section level3" number="12.3.1">
<h3>
<span class="header-section-number">12.3.1</span> Example logistic regression anaysis<a class="anchor" aria-label="anchor" href="#example-logistic-regression-anaysis"><i class="fas fa-link"></i></a>
</h3>
<p>In our example logistic regression analysis, we’ll use the same fisheries dataset from three of the navigation pools in the Upper Mississippi River that we used in our chapter on linear models. These fish data are collected to understand long-term trends of the river, but we’ll use the data to see what relationships may exist between habitat predictors and fish responses.</p>
<div id="import-and-explore-data" class="section level4" number="12.3.1.1">
<h4>
<span class="header-section-number">12.3.1.1</span> Import and explore data<a class="anchor" aria-label="anchor" href="#import-and-explore-data"><i class="fas fa-link"></i></a>
</h4>
<p>First we read in the data filter it so that it only includes data from daylight electrofishing (<code>gear == "D"</code>), backwater habitat, and depths &lt; 5 m, as this is where this gear is most accurate.</p>
<div class="sourceCode" id="cb337"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">umr_wide</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="st">"data/umr_counts_wide.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Period already filtered to 3</span></span>
<span><span class="va">umr_sub</span> <span class="op">&lt;-</span>  <span class="va">umr_wide</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">gear</span> <span class="op">==</span> <span class="st">"D"</span>,</span>
<span>         <span class="va">stratum_full</span> <span class="op">==</span> <span class="st">"Backwater"</span>,</span>
<span>         <span class="va">depth</span> <span class="op">&lt;</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Let’s look at the column names of our dataframe. We see that the last 10 columns, starting with BLGL are codes for species. These columns are counts of the different species in each sampling event.</p>
<div class="sourceCode" id="cb338"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">umr_sub</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  [1] "date"         "utm_e"        "utm_n"        "stratum_full" "year"         "period"      
##  [7] "pool"         "gear"         "secchi"       "temp"         "depth"        "cond"        
## [13] "current"      "do"           "substrt"      "vegd"         "BLGL"         "FWDM"        
## [19] "CARP"         "LMBS"         "ERSN"         "BKCP"         "SHRH"         "GZSD"        
## [25] "WTBS"         "SFSN"</code></pre>
<p>Counts can be very “noisy” data and often difficult to predict, so it’s common to instead model presence/absence. In order to do this, we can convert our counts to 1’s and 0’s using the following code. Here we are using <code>mutate</code> to change the values of each of the species columns. <code>case_when</code> is a <code>dplyr</code> function that operates similarly to an if-else statement. So here, we are saying that in all the columns with species names, if the value is greater than 0, we convert this to 1, and if the value is not (i.e., if it’s 0), it will remain 0.</p>
<div class="sourceCode" id="cb340"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">umr_sub</span><span class="op">)</span><span class="op">[</span><span class="fl">17</span><span class="op">:</span><span class="fl">26</span><span class="op">]</span></span>
<span></span>
<span><span class="va">fish_binary</span> <span class="op">&lt;-</span> <span class="va">umr_sub</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">any_of</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span>, <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">.</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="fl">1</span>, <span class="cn">TRUE</span> <span class="op">~</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We’re going to examine whether any of the predictor variables in the dataset are predictive of the occurrence of one of the species, the common carp. Being able to predict habitat variables that influence the presence of a species might be the basis for predicting how USACE management activities impact species.</p>
<p>First, let’s plot common carp occurrence as a function of several predictor variables: temperature, water transparency (i.e., secchi disk reading), depth, and conductivity. To do this most easily with ggplot, we need all of the variables in one column so we can use the <code>facet_wrap</code> function to make a singe panel for each variable. To do this we create a dataframe called <code>carp_long</code> using the <code>pivot_longer</code> function to go from a wide format to a long format, which makes the plotting seemless.</p>
<div class="sourceCode" id="cb341"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">carp_long</span> <span class="op">&lt;-</span> <span class="va">fish_binary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">CARP</span>, <span class="va">secchi</span><span class="op">:</span><span class="va">do</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">secchi</span><span class="op">:</span><span class="va">cond</span>, names_to <span class="op">=</span> <span class="st">"variable"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span></span></code></pre></div>
<p>In <code>pivot_longer</code> we tell which columns we want to combine, what we should name the column that now inclues the variable names and what we should name the column that includes the variable values.</p>
<p>Now we can plot the variables.</p>
<div class="sourceCode" id="cb342"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">carp_long</span>, </span>
<span>         <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">value</span>, <span class="va">CARP</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">.1</span>, width <span class="op">=</span> <span class="fl">.02</span>, alpha <span class="op">=</span><span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">CARP</span><span class="op">)</span>, </span>
<span>                   width <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"black"</span>, fill <span class="op">=</span> <span class="st">"gray"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, nrow <span class="op">=</span> <span class="fl">2</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Value of predictor"</span>, y <span class="op">=</span> <span class="st">"Carp occurrence"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: Removed 170 rows containing non-finite outside the scale range
## (`stat_boxplot()`).</code></pre>
<pre><code>## Warning: Removed 170 rows containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<div class="inline-figure"><img src="usace_R_training_files/figure-html/unnamed-chunk-54-1.png" width="600" height="600"></div>
<p>From these plots, a few variables pop out as being potentially important. For example locations with carp occurrences appear to have lower secchi disk readings (i.e., less clear water) and higher temperatures, but the strength of these relationships are unclear, which is where modeling comes in to play.</p>
</div>
<div id="fit-model-with-glm-function" class="section level4" number="12.3.1.2">
<h4>
<span class="header-section-number">12.3.1.2</span> Fit model with <code>glm</code> function<a class="anchor" aria-label="anchor" href="#fit-model-with-glm-function"><i class="fas fa-link"></i></a>
</h4>
<p>We’ll use the <code>glm</code> function in base R to do this, and the same kind of formula notation as with linear models, here indicating that we want to model carp occurrences as a function of four of our predictor variables. We’ll use the <code>fish_binary</code> dataset to do this. Finally we need to select a ‘family’ for the error distribution of our response variable. For presence/absence data, the binomial distribution is typically chosen because it’s a distribution with only two states, typically 1 for “success” and 0 for “failure.”</p>
<div class="sourceCode" id="cb345"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glm.bin</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">CARP</span> <span class="op">~</span> <span class="va">secchi</span> <span class="op">+</span> <span class="va">temp</span> <span class="op">+</span> <span class="va">depth</span> <span class="op">+</span> <span class="va">cond</span>,</span>
<span>            data <span class="op">=</span> <span class="va">fish_binary</span>,</span>
<span>            family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span></span></code></pre></div>
<p>We can look at the results of the model with the <code>summary</code> function.</p>
<div class="sourceCode" id="cb346"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">glm.bin</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = CARP ~ secchi + temp + depth + cond, family = binomial, 
##     data = fish_binary)
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -1.2036029  0.5342537  -2.253  0.02427 *  
## secchi      -0.0322025  0.0035546  -9.059  &lt; 2e-16 ***
## temp         0.0957375  0.0191719   4.994 5.93e-07 ***
## depth        0.9963667  0.2239745   4.449 8.64e-06 ***
## cond         0.0027675  0.0009828   2.816  0.00486 ** 
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1074.79  on 777  degrees of freedom
## Residual deviance:  936.89  on 773  degrees of freedom
##   (68 observations deleted due to missingness)
## AIC: 946.89
## 
## Number of Fisher Scoring iterations: 3</code></pre>
<p>The summary function generates output very similar to what we’ve observed with linear modeling. The Estimate column shows us the parameter estimate for our different model parameters, and we can also get an indication of whether the parameters are considered to be significant, e.g., with p-values less than 0.05. Here, we see that all the parameters are considered significant, except for conductivity.</p>
<p>But how do we interpret the model coefficient values? Let’s look at these values again:</p>
<div class="sourceCode" id="cb348"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extracting model coefficients</span></span>
<span><span class="va">glm.bin</span><span class="op">$</span><span class="va">coefficients</span></span></code></pre></div>
<pre><code>##  (Intercept)       secchi         temp        depth         cond 
## -1.203602861 -0.032202531  0.095737510  0.996366684  0.002767454</code></pre>
<p>Because logistic regression involves the logit link function, it’s not as easy as with linear modeling. Here, the coefficient values can be interpreted as the additive effect of, for example, temperature on the <strong>log odds</strong> of success.</p>
<p>The <strong>odds ratio</strong> is more interpretable than the log odds. We get this by exponentiating the coefficicent values, in other words raising e to the power of the coefficients. In R, we use the <code><a href="https://rdrr.io/r/base/Log.html">exp()</a></code> function to do this.</p>
<div class="sourceCode" id="cb350"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">glm.bin</span><span class="op">$</span><span class="va">coefficient</span><span class="op">)</span></span></code></pre></div>
<pre><code>## (Intercept)      secchi        temp       depth        cond 
##   0.3001110   0.9683104   1.1004702   2.7084234   1.0027713</code></pre>
<p>These values indicate that the odds of occurrence are 2.71 times (or 171% higher) when depth increases by a meter.</p>
<p>We can now use ggplot to generate a graph of these model results looking at the effect of depth on Carp occurrence probability. Note, however, that this is only approximate, as our model also included other parameters, and this plot merely considers depth.</p>
<div class="sourceCode" id="cb352"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">fish_binary</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">depth</span>, y <span class="op">=</span> <span class="va">CARP</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>height <span class="op">=</span> <span class="fl">0.05</span>, width <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op">(</span></span>
<span>    method <span class="op">=</span> <span class="st">"glm"</span>,</span>
<span>    method.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="va">binomial</span><span class="op">)</span>,</span>
<span>    se <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Depth (m)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Probability of presence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"Probability of presence of  Carp as a function of depth"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<div class="inline-figure"><img src="usace_R_training_files/figure-html/unnamed-chunk-59-1.png" width="600" height="600"></div>
</div>
</div>
<div id="example-poisson-regression-anaysis" class="section level3" number="12.3.2">
<h3>
<span class="header-section-number">12.3.2</span> Example poisson regression anaysis<a class="anchor" aria-label="anchor" href="#example-poisson-regression-anaysis"><i class="fas fa-link"></i></a>
</h3>
<p>What if we want to model counts? For example, do we think counts of Largemouth Bass (LMBS) might change as a function of environmental predictors? We can first plot counts of LMBS as a function of predictors using <code>ggplot</code>.</p>
<div class="sourceCode" id="cb354"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">umr_sub</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">LMBS</span>, <span class="va">secchi</span><span class="op">:</span><span class="va">do</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">secchi</span><span class="op">:</span><span class="va">do</span>, names_to <span class="op">=</span> <span class="st">"variable"</span>, values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">value</span>, <span class="va">LMBS</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>pch <span class="op">=</span> <span class="fl">21</span>, alpha <span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"glm"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">variable</span>, nrow <span class="op">=</span> <span class="fl">2</span>, scales <span class="op">=</span> <span class="st">"free_x"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = 'y ~ x'</code></pre>
<pre><code>## Warning: Removed 593 rows containing non-finite outside the scale range
## (`stat_smooth()`).</code></pre>
<pre><code>## Warning: Removed 593 rows containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<p><img src="usace_R_training_files/figure-html/unnamed-chunk-60-1.png" width="600" height="600">
There appear to be some potential relationships, but we again want to use a model to statistically assess the strength and validity of these relationships. For count data, we often use a poisson or negative-binomial distribution, which indicates that we assume the response variables (i.e., counts) has that distribution. The poisson distribution is pretty restrictive, in that it assumes that the mean and variance of the data are the same, which is often not the case with the biological data (variances are often a lot higher than the mean). In these cases, using a negative binomial distribution usually makes sense. Here we’ll use the MASS package to run a negative binomial model. Specifying the equation of the model is the same as the binomial case, but we use the function <code><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html">glm.nb()</a></code> to indicate the type of regression that we want to do.</p>
<div class="sourceCode" id="cb358"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/">MASS</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Attaching package: 'MASS'</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     select</code></pre>
<div class="sourceCode" id="cb361"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_nb</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/glm.nb.html">glm.nb</a></span><span class="op">(</span><span class="va">LMBS</span> <span class="op">~</span> <span class="va">secchi</span> <span class="op">+</span> <span class="va">temp</span> <span class="op">+</span> <span class="va">depth</span> <span class="op">+</span> <span class="va">current</span> <span class="op">+</span> <span class="va">do</span>,</span>
<span>  data <span class="op">=</span> <span class="va">umr_sub</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod_nb</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Call:
## glm.nb(formula = LMBS ~ secchi + temp + depth + current + do, 
##     data = umr_sub, init.theta = 0.9811995876, link = log)
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  1.903868   0.346735   5.491 4.00e-08 ***
## secchi       0.006629   0.001872   3.540 0.000400 ***
## temp         0.042383   0.011728   3.614 0.000302 ***
## depth       -0.131093   0.140926  -0.930 0.352256    
## current     -1.819639   0.465749  -3.907 9.35e-05 ***
## do           0.031503   0.020885   1.508 0.131458    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for Negative Binomial(0.9812) family taken to be 1)
## 
##     Null deviance: 610.56  on 496  degrees of freedom
## Residual deviance: 574.42  on 491  degrees of freedom
##   (349 observations deleted due to missingness)
## AIC: 4022.4
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  0.9812 
##           Std. Err.:  0.0626 
## 
##  2 x log-likelihood:  -4008.4440</code></pre>
<p>The summary output is similar to before, again indicating the estimates for our model coefficients, and whether the effect of these parameters are significant. We see that depth and dissolved oxygen are not significant based on p-values &gt; 0.05, whereas the other parameters are significant (denoted by the asterices). Now we can look at the value of our model coefficients to indicate the strength of these relationships.</p>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod_nb</span><span class="op">$</span><span class="va">coefficients</span></span></code></pre></div>
<pre><code>##  (Intercept)       secchi         temp        depth      current           do 
##  1.903867784  0.006628509  0.042382903 -0.131092770 -1.819638862  0.031502635</code></pre>
<p>To interpret the coefficient for current, for example, we would say that for a one-unit increase in current, the log of the expected count decreases by 1.81.If we exponentiate this coefficient (i.e., raise <code>e</code> to the power of this coefficient), it indicates that raising current by 1 m/s ( a lot! in this system) multiplies the expected count by .16, in other words, it drastically reduces the expected counts.</p>
<p>To visualize this effect, we can predict some new data and plot the results.</p>
<p>First, we create a new dataset to hold our predictions across a range of values for current. We create 100 values of current across the entire range of data in our dataset (i.e., from the minimum to the maximum value). We also include the mean values for all of the other predictors.</p>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>current <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">umr_sub</span><span class="op">$</span><span class="va">current</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">umr_sub</span><span class="op">$</span><span class="va">current</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>,</span>
<span>                 secchi <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">umr_sub</span><span class="op">$</span><span class="va">secchi</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                 temp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">umr_sub</span><span class="op">$</span><span class="va">temp</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                 depth <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">umr_sub</span><span class="op">$</span><span class="va">depth</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                 do <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">umr_sub</span><span class="op">$</span><span class="va">do</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,<span class="op">)</span></span></code></pre></div>
<p>Next we use the <code>predict</code> function to generate our predicted counts. This uses our fitted model and the new data to create the predictions. <code>se.fit</code> indicates that standard errors should be returned, and type = “link” means that we want our response on the scale of the linear predictor (i.e., log(counts) in this case).</p>
<div class="sourceCode" id="cb366"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred_link</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_nb</span>, newdata <span class="op">=</span> <span class="va">newdat</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span>, type <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span></span></code></pre></div>
<p>Now we can add the predictions from the <code>pred_link</code> object to our new data. Here we also create new columns for the confidence intervals (<code>lwr</code> and <code>upr</code>) and our predictions on the count scale.</p>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newdat</span> <span class="op">&lt;-</span> <span class="va">newdat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    fit_link <span class="op">=</span> <span class="va">pred_link</span><span class="op">$</span><span class="va">fit</span>,</span>
<span>    se_link <span class="op">=</span> <span class="va">pred_link</span><span class="op">$</span><span class="va">se.fit</span>,</span>
<span>    lwr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">fit_link</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">se_link</span><span class="op">)</span>,</span>
<span>    upr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">fit_link</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">se_link</span><span class="op">)</span>,</span>
<span>    pred_count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">fit_link</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Finally we can plot our new predicted counts across different values for current.</p>
<div class="sourceCode" id="cb368"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">newdat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">current</span>, y <span class="op">=</span> <span class="va">pred_count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">lwr</span>, ymax <span class="op">=</span> <span class="va">upr</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.2</span>, fill <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Current (m/s)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Predicted count"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Predicted counts from Negative Binomial regression"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<div class="inline-figure">
<img src="usace_R_training_files/figure-html/unnamed-chunk-66-1.png" width="600" height="600">
This indicates graphically that with the other predictors constrained to their mean values, largemouth bass counts are high when the water current is very low, but declines substantially and approaches low values as currents near 0.8 m/s.</div>
<p>Similar plots could also be made for other predictors, and models could also examine whether there are meaningful interactions between predictors. These models could be used extensively to explore whether habitat models for species of interest reflect the empirical data in a system.</p>
</div>
</div>
<div id="summary-5" class="section level2" number="12.4">
<h2>
<span class="header-section-number">12.4</span> Summary<a class="anchor" aria-label="anchor" href="#summary-5"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Generalized linear models (GLMs) examine how a response like counts is affected by environmental predictors, which can be used to inform ecological models used in USACE planning processes.</li>
<li>GLMs rely on a link function, such as the <code>logit</code> in the case of binomial models, to place the relationship between a response variable and predictor variables on the linear scale.</li>
<li>Interpretation of model results needs to account for the link function that is used, and plotting model predictions is often the most intuitive way to interpret results.</li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="linear-models.html"><span class="header-section-number">11</span> Linear Models</a></div>
<div class="next"><a href="random-effects.html"><span class="header-section-number">13</span> Random Effects</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#generalized-linear-models"><span class="header-section-number">12</span> Generalized Linear Models</a></li>
<li><a class="nav-link" href="#learning-objectives-8"><span class="header-section-number">12.1</span> Learning objectives</a></li>
<li><a class="nav-link" href="#generalized-linear-model-background"><span class="header-section-number">12.2</span> Generalized Linear Model Background</a></li>
<li>
<a class="nav-link" href="#logistic-regression"><span class="header-section-number">12.3</span> Logistic regression</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#example-logistic-regression-anaysis"><span class="header-section-number">12.3.1</span> Example logistic regression anaysis</a></li>
<li><a class="nav-link" href="#example-poisson-regression-anaysis"><span class="header-section-number">12.3.2</span> Example poisson regression anaysis</a></li>
</ul>
</li>
<li><a class="nav-link" href="#summary-5"><span class="header-section-number">12.4</span> Summary</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Using R for ecological modeling in USACE</strong>" was written by Ed Stowe. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
