<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>22 Important data sources | Using R for ecological modeling in USACE</title>
<meta name="author" content="Ed Stowe">
<meta name="generator" content="bookdown 0.42 with bs4_book()">
<meta property="og:title" content="22 Important data sources | Using R for ecological modeling in USACE">
<meta property="og:type" content="book">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="22 Important data sources | Using R for ecological modeling in USACE">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.8.0/transition.js"></script><script src="libs/bs3compat-0.8.0/tabs.js"></script><script src="libs/bs3compat-0.8.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<meta name="description" content="Authors: Brian Breaker, USACE (dataRetrieval section); Ed Stowe (adaptation, edits)Last update: 2025-02-03Acknowledgements:  22.1 USGS gage data using the dataRetrieval package This exercise uses...">
<meta property="og:description" content="Authors: Brian Breaker, USACE (dataRetrieval section); Ed Stowe (adaptation, edits)Last update: 2025-02-03Acknowledgements:  22.1 USGS gage data using the dataRetrieval package This exercise uses...">
<meta name="twitter:description" content="Authors: Brian Breaker, USACE (dataRetrieval section); Ed Stowe (adaptation, edits)Last update: 2025-02-03Acknowledgements:  22.1 USGS gage data using the dataRetrieval package This exercise uses...">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Using R for ecological modeling in USACE</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Course overview</a></li>
<li><a class="" href="required-set-up-for-the-course.html">Required set-up for the course</a></li>
<li class="book-part">Basic Training on R and RStudio</li>
<li><a class="" href="introduction-to-r-and-rstudio.html"><span class="header-section-number">1</span> Introduction to R and RStudio</a></li>
<li><a class="" href="data-visualization-with-ggplot2.html"><span class="header-section-number">2</span> Data Visualization with ggplot2</a></li>
<li><a class="" href="exploring-and-understanding-data.html"><span class="header-section-number">3</span> Exploring and understanding data</a></li>
<li><a class="" href="manipulating-tabular-data.html"><span class="header-section-number">4</span> Manipulating Tabular Data</a></li>
<li class="book-part">Ecological Modeling in R</li>
<li><a class="" href="conceptual-ecological-models.html"><span class="header-section-number">5</span> Conceptual Ecological Models</a></li>
<li class="book-part">Habitat Models</li>
<li><a class="" href="background-on-habitat-models-in-usace.html"><span class="header-section-number">6</span> Background on habitat models in USACE</a></li>
<li><a class="" href="habitat-suitability-index-models-with-ecorest.html"><span class="header-section-number">7</span> Habitat Suitability Index models with ecorest</a></li>
<li><a class="" href="ecorest-web-app.html"><span class="header-section-number">8</span> Ecorest Web App</a></li>
<li><a class="" href="spatial-habitat-models.html"><span class="header-section-number">9</span> Spatial Habitat Models</a></li>
<li class="book-part">Linear Models</li>
<li><a class="" href="linear-models.html"><span class="header-section-number">10</span> Linear Models</a></li>
<li><a class="" href="generalized-linear-models.html"><span class="header-section-number">11</span> Generalized Linear Models</a></li>
<li><a class="" href="random-effects.html"><span class="header-section-number">12</span> Random Effects</a></li>
<li class="book-part">Machine Learning</li>
<li><a class="" href="random-forest.html"><span class="header-section-number">13</span> Random Forest</a></li>
<li><a class="" href="boosted-regression-trees.html"><span class="header-section-number">14</span> Boosted Regression Trees</a></li>
<li><a class="" href="population-modeling.html"><span class="header-section-number">15</span> Population Modeling</a></li>
<li><a class="" href="network-models-and-connectivity.html"><span class="header-section-number">16</span> Network Models and Connectivity</a></li>
<li><a class="" href="agent-based-models.html"><span class="header-section-number">17</span> Agent-based Models</a></li>
<li class="book-part">Models and decision-making</li>
<li><a class="" href="decision-support.html"><span class="header-section-number">18</span> Decision Support</a></li>
<li><a class="" href="annualizing-benefits-and-costs-with-ecorest-and-engrecon.html"><span class="header-section-number">19</span> Annualizing benefits and costs with ecorest and EngrEcon</a></li>
<li><a class="" href="ceica-chapter.html"><span class="header-section-number">20</span> Cost-Effectiveness and Incremental Cost Analysis (CEICA) with ecorest</a></li>
<li class="book-part">Other R applications</li>
<li><a class="" href="spatial-data-manipulation.html"><span class="header-section-number">21</span> Spatial Data Manipulation</a></li>
<li><a class="active" href="important-data-sources.html"><span class="header-section-number">22</span> Important data sources</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="important-data-sources" class="section level1" number="22">
<h1>
<span class="header-section-number">22</span> Important data sources<a class="anchor" aria-label="anchor" href="#important-data-sources"><i class="fas fa-link"></i></a>
</h1>
<p><em>Authors: Brian Breaker, USACE (dataRetrieval section); Ed Stowe (adaptation, edits)</em><br><em>Last update: 2025-02-03</em><br><em>Acknowledgements: </em></p>
<div id="usgs-gage-data-using-the-dataretrieval-package" class="section level2" number="22.1">
<h2>
<span class="header-section-number">22.1</span> USGS gage data using the dataRetrieval package<a class="anchor" aria-label="anchor" href="#usgs-gage-data-using-the-dataretrieval-package"><i class="fas fa-link"></i></a>
</h2>
<p>This exercise uses the USGS dataRetrieval package from the USGS to explore
data availability and retrieve data. The USGS dataRetrieval package accesses the NWIS web portal.
Documentation for the packages can be found at:
<a href="https://github.com/USGS-R/dataRetrieval" class="uri">https://github.com/USGS-R/dataRetrieval</a></p>
<div class="sourceCode" id="cb364"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://code.usgs.gov/water/dataRetrieval">dataRetrieval</a></span><span class="op">)</span></span></code></pre></div>
<p>Let’s start by seeing what streamflow data is available for Arkansas (AR)? To do this we can use the <code>whatNWISsites</code> function.
Here, Parameter code 00060 refers to daily flow in cubic feet per second (cfs).</p>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">whatSites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dataRetrieval/man/whatNWISsites.html">whatNWISsites</a></span><span class="op">(</span>stateCd <span class="op">=</span> <span class="st">"AR"</span>, parameterCd <span class="op">=</span> <span class="st">"00060"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## GET: https://waterservices.usgs.gov/nwis/site/?stateCd=AR&amp;parameterCd=00060&amp;format=mapper</code></pre>
<p>These can be subset to just active sites, or just ones with unit-value flow data (e.g., 15 min flow).</p>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">whatSites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dataRetrieval/man/whatNWISsites.html">whatNWISsites</a></span><span class="op">(</span>stateCd <span class="op">=</span> <span class="st">"AR"</span>, parameterCd <span class="op">=</span> <span class="st">"00060"</span>, </span>
<span>                           siteStatus <span class="op">=</span> <span class="st">"active"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## GET: https://waterservices.usgs.gov/nwis/site/?stateCd=AR&amp;parameterCd=00060&amp;siteStatus=active&amp;format=mapper</code></pre>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">whatSites</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dataRetrieval/man/whatNWISsites.html">whatNWISsites</a></span><span class="op">(</span>stateCd <span class="op">=</span> <span class="st">"AR"</span>, parameterCd <span class="op">=</span> <span class="st">"00060"</span>, </span>
<span>                           siteStatus <span class="op">=</span> <span class="st">"active"</span>, hasDataTypeCd <span class="op">=</span> <span class="st">"dv"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## GET: https://waterservices.usgs.gov/nwis/site/?stateCd=AR&amp;parameterCd=00060&amp;siteStatus=active&amp;hasDataTypeCd=dv&amp;format=mapper</code></pre>
<p>Now we have some sites to look at, but we can further reduce these. For example, what if we just want sites on the Buffalo River? This will require some filtering using character strings. Hint: look at ?str_detect</p>
<div class="sourceCode" id="cb371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># filter all of our sites by the "Buffalo" in station name</span></span>
<span><span class="va">whatSites</span> <span class="op">&lt;-</span> <span class="va">whatSites</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">station_nm</span>, <span class="st">"Buffalo"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># what information is available for those sites? includes start and end dates</span></span>
<span><span class="va">whatInfo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dataRetrieval/man/whatNWISdata.html">whatNWISdata</a></span><span class="op">(</span>siteNumber <span class="op">=</span> <span class="va">whatSites</span><span class="op">$</span><span class="va">site_no</span><span class="op">)</span></span></code></pre></div>
<pre><code>## GET: https://waterservices.usgs.gov/nwis/site/?seriesCatalogOutput=true&amp;sites=07055646,07055660,07055680,07056000,07056700&amp;format=rdb</code></pre>
<pre><code>## WARNING: NWIS does not deliver
## discrete water quality data newer than March 11, 2024
## or updates to existing data. For additional details, see:
## https://doi-usgs.github.io/dataRetrieval/articles/Status.html</code></pre>
<div class="sourceCode" id="cb374"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># we don't want to look at water quality data... so let's filter it out</span></span>
<span><span class="va">whatInfo</span> <span class="op">&lt;-</span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">whatInfo</span>, <span class="op">!</span><span class="va">data_type_cd</span> <span class="op">==</span> <span class="st">"qw"</span><span class="op">)</span></span></code></pre></div>
<p>Now we can get some flow data for these 5 sites on the Buffalo River.</p>
<p>The “uv” is going to retrieve the 15min data and Sys.Date is set equal to the date the script is run.</p>
<div class="sourceCode" id="cb375"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flowDat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dataRetrieval/man/readNWISuv.html">readNWISuv</a></span><span class="op">(</span><span class="va">whatSites</span><span class="op">$</span><span class="va">site_no</span>, startDate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date</a></span><span class="op">(</span><span class="op">)</span>, parameterCd <span class="op">=</span> <span class="st">"00060"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## GET: https://waterservices.usgs.gov/nwis/iv/?site=07055646,07055660,07055680,07056000,07056700&amp;format=waterml,1.1&amp;ParameterCd=00060&amp;startDT=2025-02-06</code></pre>
<div class="sourceCode" id="cb377"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Rename unwieldy names; dataRetrieval has a function to do that.</span></span>
<span><span class="va">flowDat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dataRetrieval/man/renameNWISColumns.html">renameNWISColumns</a></span><span class="op">(</span><span class="va">flowDat</span><span class="op">)</span></span></code></pre></div>
<p>We can also get data associated with each of these gages using the <code>siteInfo</code> function, including data on drainage area.</p>
<div class="sourceCode" id="cb378"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">siteInfo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dataRetrieval/man/readNWISsite.html">readNWISsite</a></span><span class="op">(</span><span class="va">whatSites</span><span class="op">$</span><span class="va">site_no</span><span class="op">)</span></span></code></pre></div>
<pre><code>## GET: https://waterservices.usgs.gov/nwis/site/?siteOutput=Expanded&amp;format=rdb&amp;site=07055646,07055660,07055680,07056000,07056700</code></pre>
<div class="sourceCode" id="cb380"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># What if we just want site number and drainage area for the sites</span></span>
<span><span class="va">siteInfo</span> <span class="op">&lt;-</span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">siteInfo</span>, <span class="va">site_no</span>, <span class="va">drain_area_va</span><span class="op">)</span></span></code></pre></div>
<p>Let’s have look at our data, the mean flow data for the last hour for each site create a simple time-series plot</p>
<div class="sourceCode" id="cb381"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">flowDat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dateTime</span>, y <span class="op">=</span> <span class="va">Flow_Inst</span>, color <span class="op">=</span> <span class="va">site_no</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span></span></code></pre></div>
<div class="inline-figure"><img src="usace_R_training_files/figure-html/unnamed-chunk-86-1.png" width="600" height="600"></div>
<p>Now if we wanted to convert the data to hourly data saved at the end of the hour.</p>
<p>Create a new data frame so you can open both up and look back and forth to see what you are changing with each step</p>
<div class="sourceCode" id="cb382"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flowDat2</span> <span class="op">&lt;-</span> <span class="va">flowDat</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>dateTime <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span><span class="op">(</span><span class="va">dateTime</span>, format <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M:%S"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>date_hour <span class="op">=</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/round_date.html">floor_date</a></span><span class="op">(</span><span class="va">dateTime</span>, unit <span class="op">=</span> <span class="st">"hour"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">site_no</span>, <span class="va">date_hour</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>flow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">Flow_Inst</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># is there a relationship between flow and drainage area</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">flowDat</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">dateTime</span>, y <span class="op">=</span> <span class="va">Flow_Inst</span>, color <span class="op">=</span> <span class="va">site_no</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">flowDat2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_hour</span>, y <span class="op">=</span> <span class="va">flow</span> , color <span class="op">=</span> <span class="va">site_no</span><span class="op">)</span>,</span>
<span>               linetype<span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="usace_R_training_files/figure-html/unnamed-chunk-87-1.png" width="600" height="600"></div>
<p>We can also download daily data starting many years ago, including data starting in water year 2020 from these 5 sites on the Buffalo River.</p>
<div class="sourceCode" id="cb383"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flowDatdaily</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dataRetrieval/man/readNWISdv.html">readNWISdv</a></span><span class="op">(</span><span class="va">whatSites</span><span class="op">$</span><span class="va">site_no</span>, startDate <span class="op">=</span> <span class="st">"2019-10-01"</span>, parameterCd <span class="op">=</span> <span class="st">"00060"</span><span class="op">)</span></span>
<span><span class="va">flowDatdaily</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dataRetrieval/man/renameNWISColumns.html">renameNWISColumns</a></span><span class="op">(</span><span class="va">flowDatdaily</span><span class="op">)</span></span></code></pre></div>
<p>We can plot the data using ggplot.</p>
<div class="sourceCode" id="cb384"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">flowDatdaily</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Date</span>, y <span class="op">=</span> <span class="va">Flow</span>, color <span class="op">=</span> <span class="va">site_no</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">500000</span>, <span class="fl">5000</span><span class="op">)</span> <span class="op">)</span><span class="op">+</span> </span>
<span>     <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html">scale_x_date</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="st">"6 month"</span>, labels<span class="op">=</span><span class="fu"><a href="https://scales.r-lib.org/reference/date_format.html">date_format</a></span><span class="op">(</span><span class="st">"%Y-%m"</span><span class="op">)</span>,expand <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="usace_R_training_files/figure-html/unnamed-chunk-89-1.png" width="600" height="600"></div>
<p>If you wanted to write out the gages instead of filtering the data,
you can reference the site number directly in the function.</p>
<div class="sourceCode" id="cb385"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flowDatdailyone</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dataRetrieval/man/readNWISdv.html">readNWISdv</a></span><span class="op">(</span><span class="st">"07055646"</span>, startDate <span class="op">=</span> <span class="st">"2019-10-01"</span>, parameterCd <span class="op">=</span> <span class="st">"00060"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## GET: https://waterservices.usgs.gov/nwis/dv/?site=07055646&amp;format=waterml,1.1&amp;ParameterCd=00060&amp;StatCd=00003&amp;startDT=2019-10-01</code></pre>
<div class="sourceCode" id="cb387"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">flowDatdailytwo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dataRetrieval/man/readNWISdv.html">readNWISdv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"07055646"</span>, <span class="st">"07055660"</span><span class="op">)</span>, startDate <span class="op">=</span> <span class="st">"2019-10-01"</span>, parameterCd <span class="op">=</span> <span class="st">"00060"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## GET: https://waterservices.usgs.gov/nwis/dv/?site=07055646,07055660&amp;format=waterml,1.1&amp;ParameterCd=00060&amp;StatCd=00003&amp;startDT=2019-10-01</code></pre>
</div>
<div id="national-hydrography-dataset-with-nhdplustools" class="section level2" number="22.2">
<h2>
<span class="header-section-number">22.2</span> National Hydrography Dataset with nhdplusTools<a class="anchor" aria-label="anchor" href="#national-hydrography-dataset-with-nhdplustools"><i class="fas fa-link"></i></a>
</h2>
<p><a href="https://doi-usgs.github.io/nhdplusTools/" class="uri">https://doi-usgs.github.io/nhdplusTools/</a></p>
</div>
<div id="nlcd" class="section level2" number="22.3">
<h2>
<span class="header-section-number">22.3</span> NLCD<a class="anchor" aria-label="anchor" href="#nlcd"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="precipitation-data-prism" class="section level2" number="22.4">
<h2>
<span class="header-section-number">22.4</span> Precipitation data (PRISM)<a class="anchor" aria-label="anchor" href="#precipitation-data-prism"><i class="fas fa-link"></i></a>
</h2>
</div>
<div id="other-data-sources-commonly-used-in-usace" class="section level2" number="22.5">
<h2>
<span class="header-section-number">22.5</span> Other data sources commonly used in USACE?<a class="anchor" aria-label="anchor" href="#other-data-sources-commonly-used-in-usace"><i class="fas fa-link"></i></a>
</h2>

</div>
</div>







  <div class="chapter-nav">
<div class="prev"><a href="spatial-data-manipulation.html"><span class="header-section-number">21</span> Spatial Data Manipulation</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#important-data-sources"><span class="header-section-number">22</span> Important data sources</a></li>
<li><a class="nav-link" href="#usgs-gage-data-using-the-dataretrieval-package"><span class="header-section-number">22.1</span> USGS gage data using the dataRetrieval package</a></li>
<li><a class="nav-link" href="#national-hydrography-dataset-with-nhdplustools"><span class="header-section-number">22.2</span> National Hydrography Dataset with nhdplusTools</a></li>
<li><a class="nav-link" href="#nlcd"><span class="header-section-number">22.3</span> NLCD</a></li>
<li><a class="nav-link" href="#precipitation-data-prism"><span class="header-section-number">22.4</span> Precipitation data (PRISM)</a></li>
<li><a class="nav-link" href="#other-data-sources-commonly-used-in-usace"><span class="header-section-number">22.5</span> Other data sources commonly used in USACE?</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Using R for ecological modeling in USACE</strong>" was written by Ed Stowe. </p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
